
{% block titulo %}
    {{ accion }} Programa
{% endblock titulo %}
    

{% block contenido %}
    <form id="programa" method="post">
        {% csrf_token %}
        {{ programaForm.as_p }}

        <button type="button" id="enviar">{{ boton }}</button>
    </form>
{% endblock contenido %}

{% block scripts %}
    <script>
        $(document).ready(function () {
            $("#programa").bind("submit",function(){
                // Capturamnos el boton de envío
                var btnEnviar = $("#btnEnviar");
                $.ajax({
                    type: "post",
                    url: "/programa/",
                    data:$(this).serialize(),
                    beforeSend: function(){
                        /*
                        * Esta función se ejecuta durante el envió de la petición al
                        * servidor.
                        * */
                        // btnEnviar.text("Enviando"); Para button 
                        btnEnviar.val("Enviando"); // Para input de tipo button
                        btnEnviar.attr("disabled","disabled");
                    },
                    complete:function(data){
                        /*
                        * Se ejecuta al termino de la petición
                        * */
                        btnEnviar.val("Enviar formulario");
                        btnEnviar.removeAttr("disabled");
                    },
                    success: function(data){
                        /*
                        * Se ejecuta cuando termina la petición y esta ha sido
                        * correcta
                        * */
                        $(".respuesta").html(data);
                    },
                    error: function(data){
                        /*
                        * Se ejecuta si la peticón ha sido erronea
                        * */
                        alert("Problemas al tratar de enviar el formulario");
                    }
                });
                // Nos permite cancelar el envio del formulario
                return false;
            });
        });
    </script>    
{% endblock scripts %}  
